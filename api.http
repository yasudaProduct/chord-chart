### ChordBook API - REST Client (humao.rest-client)
### 使用方法:
### 1. Supabaseでログイン後、ブラウザのDevToolsまたは supabase.auth.getSession() から access_token を取得
### 2. @accessToken の値を置き換える
### 3. またはプロジェクトルートに .env を作成し accessToken=xxx を定義し、下記の $dotenv 行のコメントを外す

@baseUrl = http://localhost:5000/api

@apikey = sb_publishable_ACJWlzQHlZjBrEguHvfOxg_3BJgxAaH

###############################################################################
# Health Check（認証不要）
###############################################################################

### ヘルスチェック
GET {{baseUrl}}/health
Content-Type: application/json

### Supabase 新規登録（メール確認無効時は access_token が返る）
# @name signup
POST http://127.0.0.1:54321/auth/v1/signup
Content-Type: application/json
apikey: {{apikey}}

{
  "email": "new-user@example.com",
  "password": "password"
}

### Supabase ログイン（トークン取得）
# @name login
POST http://127.0.0.1:54321/auth/v1/token?grant_type=password
Content-Type: application/json
apikey: {{apikey}}

{
  "email": "new-user@example.com",
  "password": "password"
}   

### ログイン実行後、下の変数でトークンを参照
@accessToken = {{login.response.body.access_token}}

###############################################################################
# Songs API（認証必要）
###############################################################################

### 楽曲一覧を取得
GET {{baseUrl}}/songs
Authorization: Bearer {{accessToken}}
Content-Type: application/json

### 楽曲詳細を取得（id を実際のUUIDに置き換えてください）
@songId = 00000000-0000-0000-0000-000000000000
GET {{baseUrl}}/songs/{{songId}}
Authorization: Bearer {{accessToken}}
Content-Type: application/json

### 楽曲を作成
POST {{baseUrl}}/songs
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "title": "新しい曲",
  "artist": "アーティスト名",
  "key": "C",
  "bpm": 120,
  "timeSignature": "4/4"
}

### 楽曲を更新（songId を実際のUUIDに置き換えてください）
PUT {{baseUrl}}/songs/{{songId}}
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "title": "更新後の曲名",
  "artist": "更新後のアーティスト",
  "key": "Am",
  "bpm": 110,
  "timeSignature": "4/4",
  "content": [
    { "id": "section-1", "name": "Aメロ", "type": "bar", "lines": [] }
  ]
}

### 楽曲を削除（songId を実際のUUIDに置き換えてください）
DELETE {{baseUrl}}/songs/{{songId}}
Authorization: Bearer {{accessToken}}
